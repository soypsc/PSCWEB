<aside id="sidebar" class="bg-white text-slate-600 w-64 p-4 space-y-6 fixed inset-y-0 left-0 transform -translate-x-full md:relative md:translate-x-0 z-30 shadow-lg md:shadow-none flex flex-col">
    <div>
        <div class="flex items-center gap-3 mb-8 px-2">
            <div class="bg-emerald-500 p-2 rounded-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" /></svg>
            </div>
            <h1 class="text-xl font-bold text-slate-800">SGL1</h1>
        </div>
        
        <nav class="space-y-1">
            <h2 class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 px-4">Operaciones</h2>
            <a href="./index.html" class="sidebar-link flex items-center gap-3 px-4 py-2 rounded-lg" data-path="index.html"><span>Dashboard</span></a>
            <a href="./recibir-paquete.html" class="sidebar-link flex items-center gap-3 px-4 py-2 rounded-lg" data-path="recibir-paquete.html"><span>Recibir Paquete</span></a>
            <a href="./recibirsucursal.html" class="sidebar-link flex items-center gap-3 px-4 py-2 rounded-lg" data-path="recibirsucursal.html"><span>Recibir en Sucursal</span></a>
            <a href="./clientes.html" class="sidebar-link flex items-center gap-3 px-4 py-2 rounded-lg" data-path="clientes.html"><span>Clientes</span></a>
            <a href="./paquetes.html" class="sidebar-link flex items-center gap-3 px-4 py-2 rounded-lg" data-path="paquetes.html"><span>Paquetes</span></a>
            <a href="./sucursales.html" class="sidebar-link flex items-center gap-3 px-4 py-2 rounded-lg" data-path="sucursales.html"><span>Sucursales</span></a>
            <a href="./cobrar.html" class="sidebar-link flex items-center gap-3 px-4 py-2 rounded-lg" data-path="cobrar.html"><span>Cobrar y Facturar</span></a>
            
            <h2 class="text-xs font-semibold text-slate-400 uppercase tracking-wider mt-6 mb-2 px-4 pt-4 border-t">Administración</h2>
            <a href="./usuarios.html" class="sidebar-link flex items-center gap-3 px-4 py-2 rounded-lg" data-path="usuarios.html"><span>Usuarios y Roles</span></a>
            <a href="./configuracion.html" class="sidebar-link flex items-center gap-3 px-4 py-2 rounded-lg" data-path="configuracion.html"><span>Configuración</span></a>
            <a href="./notificaciones.html" class="sidebar-link flex items-center gap-3 px-4 py-2 rounded-lg" data-path="notificaciones.html"><span>Notificaciones</span></a>
            <a href="./anaqueles.html" class="sidebar-link flex items-center gap-3 px-4 py-2 rounded-lg" data-path="anaqueles.html"><span>Anaqueles</span></a>
            <a href="./promoregistros.html" class="sidebar-link flex items-center gap-3 px-4 py-2 rounded-lg" data-path="promoregistros.html"><span>Promo Codes</span></a>
            <a href="./cupones.html" class="sidebar-link flex items-center gap-3 px-4 py-2 rounded-lg" data-path="cupones.html"><span>Cupones</span></a>
            <a href="./metodos-pago.html" class="sidebar-link flex items-center gap-3 px-4 py-2 rounded-lg" data-path="metodos-pago.html"><span>Metodos de Pago</span></a>
            <a href="./plantillas.html" class="sidebar-link flex items-center gap-3 px-4 py-2 rounded-lg" data-path="plantillas.html"><span>Plantillas</span></a>
        </nav>
    </div>

    <div class="mt-auto pt-4 border-t">
        <a href="#" id="logout-button" class="flex items-center gap-3 px-4 py-2 rounded-lg text-red-600 hover:bg-red-50">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
            <span>Cerrar Sesión</span>
        </a>
    </div>
</aside>

<script type="module">
    import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

    // Esta función se ejecutará después de que el menú se cargue en la página principal
    function initializeLogout() {
        // Asegúrate de que config.js ya se haya cargado en la página principal
        if (!window.PSC_CONFIG) {
            console.error("La configuración de Supabase (config.js) no se encontró.");
            return;
        }
        const supabase = createClient(window.PSC_CONFIG.supabaseUrl, window.PSC_CONFIG.supabaseAnonKey);
        
        const logoutButton = document.getElementById('logout-button');

        if (logoutButton) {
            logoutButton.addEventListener('click', async (e) => {
                e.preventDefault(); // Prevenir que el enlace navegue
                
                const { error } = await supabase.auth.signOut();

                if (error) {
                    console.error('Error al cerrar sesión:', error.message);
                    alert('Error al cerrar sesión.');
                } else {
                    // Redirigir a la página de login después de cerrar sesión
                    window.location.href = 'login.html';
                }
            });
        }
    }

    // El archivo app.js ya se encarga de llamar a la lógica del menú, 
    // pero si este menú se carga solo, esto asegura que el botón funcione.
    // Para que sea más robusto, la llamada a initializeLogout() debería estar en tu app.js
    // dentro de la función que carga el menú. Por ahora, esto funcionará.
    document.addEventListener('DOMContentLoaded', initializeLogout);
    
    // Si el menú ya está visible cuando el script se ejecuta (caso común)
    if (document.readyState === 'interactive' || document.readyState === 'complete') {
        initializeLogout();
    }
</script>









